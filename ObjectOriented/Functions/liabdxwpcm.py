from numpy import log
from scipy.special import loggamma
from numpy import array, frompyfunc
def fp(p0,p1,p2,p3):
  S = array([array([1.90392796+2.45080339j, 1.76875079-2.78246272j,
       1.61529094-1.57168896j, 1.47946728+0.89674861j,
       1.56758026+3.1227615j , 1.89159843+1.34367547j,
       1.6066156 +1.43256215j, 1.48931652+2.49856102j,
       1.5873054 -0.6132659j , 1.28287406+1.52604161j,
       1.81252717+1.41916958j, 1.34793454+1.89319814j,
       1.85904851-1.71189879j, 1.33642223-3.10551733j,
       1.4186397 +3.12065927j, 1.46117447-1.4855123j ,
       1.70683836+0.80749568j, 1.71572598+1.05414339j,
       1.01812838+2.61871514j, 1.23512045+2.52692981j,
       1.02964607-2.25156012j, 1.81704433+0.6327646j ,
       1.63518208-1.8993767j , 1.81400662-0.22844794j,
       1.17067017-0.95598857j, 1.32111078-0.55463323j,
       1.86522121+0.76298051j, 1.12206701+0.57068176j,
       1.885987  -1.40101461j, 1.5719512 +3.09108142j,
       1.41617214+1.6720507j , 1.09600227-0.02669276j,
       1.28840606-2.36712927j, 1.41641403-0.70922782j,
       1.63286891-0.14311719j, 1.40255508-0.32027933j,
       1.90141892-2.93190047j, 1.95964167+0.46643322j,
       1.0722267 -1.97618156j, 1.64662755+1.38704805j,
       1.604712  +2.6468046j , 1.49830786+1.23361137j,
       1.63201647-0.53403166j, 1.66773057+2.50859034j,
       1.52090815-2.02164614j, 1.90519669-2.87755828j,
       1.65482846-2.90940842j, 1.2752085 +0.86529805j,
       1.28995706-0.66914254j, 1.75151716+2.74835535j,
       1.7518315 -2.06444741j, 1.93371788+1.45590605j,
       1.47532592-3.07903918j, 1.32171745+0.43144923j,
       1.93838802-1.1870093j , 1.25415575+1.82148209j,
       1.09242384+2.82549066j, 1.67633483+2.39783225j,
       1.6787928 +1.95227862j, 1.77226778-2.67946529j,
       1.98750401-1.2736746j , 1.86242807-0.45400176j,
       1.84292199-1.45330993j, 1.78492587+3.01372333j,
       1.09854316+0.57636171j, 1.50331555+0.61629736j,
       1.13714567+2.25951521j, 1.89216383+1.03520152j,
       1.10882108-2.87834755j, 1.96944674+0.0496412j ,
       1.4510041 -0.21921835j, 1.1192376 +2.17416622j,
       1.03009705+0.84228003j, 1.68852119-0.96857521j,
       1.5752852 +0.69443692j, 1.17242857+1.87522465j,
       1.15421902+1.99950475j, 1.11914905+0.98710229j,
       1.1179619 +2.71861755j, 1.8376256 +1.44031858j,
       1.80264713+1.80562441j, 1.1854069 -0.88751514j,
       1.85882088-2.15356426j, 1.27070843+0.52263389j,
       1.73085605-1.32956257j, 1.45075363-0.89576201j,
       1.19128566+2.36069856j, 1.45239418-1.08020397j,
       1.46423404+1.30083261j, 1.29371316-3.07596854j,
       1.39929981-2.01147782j, 1.74456916-0.922097j  ,
       1.85732998-2.62677607j, 1.69187089-1.87335536j,
       1.65171527+2.87759365j, 1.26144958+2.74367672j,
       1.10215722+0.25571932j, 1.8594584 +2.07978721j,
       1.24374964+1.51462264j, 1.70429194+2.68517438j])])
  ret = 0
  ret += log(p0**2)
  ret += S*log(p1**2)
  ret += loggamma(p2 + S*p3)
  return ret
fingerprint = frompyfunc(fp,4,1)
