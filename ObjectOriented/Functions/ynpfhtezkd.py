from scipy.special import loggamma
from numpy import log
from numpy import array, frompyfunc
def fp(p0,p1,p2,p3):
  S = array([array([3.27473354+0.52963801j, 3.12710277+0.77040564j,
       2.69897519+0.9903083j , 3.10902491-2.97602957j,
       1.46900308+0.11989156j, 2.30593305-3.07556148j,
       2.83175976-2.29824446j, 1.38633193+2.06253151j,
       3.57593404-0.04476606j, 2.2921005 -2.54628706j,
       3.84456492-1.22497962j, 2.17121584+0.16148551j,
       3.05719651-1.6522906j , 1.56965665-1.77827529j,
       2.23577887-1.57073293j, 3.73929189-2.14803118j,
       3.36542755-0.26523034j, 2.07278516-0.97295275j,
       1.5352488 -1.24374834j, 3.26607733+1.34144619j,
       1.40885262-2.84219371j, 1.99796034+1.55107719j,
       1.84434554+1.9212695j , 1.19256939+1.61636403j,
       3.11927463-0.88871618j, 1.14647255-2.88567942j,
       3.47743895-2.39727723j, 2.23794031+0.48089473j,
       3.00686492-0.43529574j, 2.93176876+0.5686602j ,
       1.20354599+2.51412446j, 3.41558591-0.77586344j,
       3.40399466-2.1331214j , 3.97699737-1.51634005j,
       1.99703754+0.05489091j, 2.71879979-0.41884559j,
       2.72416718+0.0542002j , 1.99161345-0.24382536j,
       2.65940006+1.99681734j, 2.54181922+0.08879451j,
       2.77980881-1.25336215j, 2.64469509+1.76008473j,
       3.57094284-0.74651844j, 1.94795091+0.3607831j ,
       2.27046353-2.08104418j, 2.55516268-1.54345816j,
       3.94077155-3.03459868j, 2.53088309-0.47117711j,
       1.07794556+0.99478311j, 1.59613914+2.88062315j,
       2.03252941+0.60516089j, 1.25552393+2.99614826j,
       1.08297674-2.43280068j, 2.70307707-2.91153705j,
       1.45969444-1.79955643j, 2.80181145-2.63134958j,
       2.9682051 +1.05778189j, 2.87531989-1.10552813j,
       1.06552925-2.06504751j, 3.14111302-1.89401924j,
       2.4320754 -2.14194643j, 1.31563423+2.84924398j,
       1.11434775-2.25117335j, 1.87198262+3.13420169j,
       3.98670167+0.23180824j, 3.4650754 -0.69769883j,
       3.34622237-1.22227123j, 1.82763458-2.0371841j ,
       3.17883721-0.58770854j, 3.87464171+0.33634279j,
       2.23563646-1.92619866j, 3.07392713+1.95743901j,
       1.69551833+1.08776119j, 3.74851595-1.57926424j,
       3.07074185-1.40873924j, 2.73502938+2.69781681j,
       2.31544601-0.91530704j, 2.77132974+0.27619804j,
       2.62452929+0.63903542j, 3.70386686-0.58714627j,
       2.7977317 +2.02833576j, 2.58483782-0.70007026j,
       3.13166599+2.84217124j, 3.50488037-0.41045804j,
       3.54118704-2.17516544j, 3.49018178-0.7918394j ,
       3.63478615-0.18972927j, 3.12376101-2.71862973j,
       1.0742661 +2.47017581j, 2.11779487-0.75077748j,
       2.51542891-0.25584051j, 1.94364741-2.22664903j,
       3.82231243+0.66239582j, 2.9582959 -3.08191852j,
       1.27716996-0.73473815j, 3.80065147+2.60076377j,
       3.47540839-0.82762414j, 3.82449664-0.33720833j,
       1.0438673 +2.30346342j, 2.68696652-0.36242356j])])
  ret = 0
  ret += log(p0**2)
  ret += S*log(p1**2)
  ret += loggamma(p2 + S*p3)
  return ret
fingerprint = frompyfunc(fp,4,1)
